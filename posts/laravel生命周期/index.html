<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Laravel ç”Ÿå‘½å‘¨æœŸ | ğŸ’ŠTime Capsule</title><meta name=keywords content="Laravel,PHP"><meta name=description content="Laravel ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸæ¦‚è¿° å…¥å£ publuc/index.phpæ˜¯ä¸€ä¸ªLaravelåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œæ˜¯æ•´ä¸ªæ¡†æ¶çš„èµ·ç‚¹ã€‚index.phpä»£ç ä¸å¤šï¼Œä¸»è¦çš„é˜¶æ®µå°±æ˜¯ï¼š
 åŠ è½½Composeré¡¹ç›®ä¾èµ– åˆ›å»ºä¸€ä¸ªappå®ä¾‹å®¹å™¨ æ¥æ”¶å¹¶ä¸”å¤„ç†httpè¯·æ±‚  ç”Ÿå‘½å‘¨æœŸè¯¦è§£ åŠ è½½é¡¹ç›®ä¾èµ– Laravelä½¿ç”¨Composerè¿›è¡ŒåŒ…çš„ç®¡ç†ï¼Œæ‰€æœ‰ç»„ä»¶çš„åŠ è½½å·¥ä½œï¼Œä»…éœ€è¦ä¸€è¡Œä»£ç 
require __DIR__.'/../vendor/autoload.php'; åˆ›å»ºAppå®ä¾‹ æ¥ä¸‹æ¥ä¾¿æ˜¯åˆ›å»ºåº”ç”¨å®ä¾‹(Illuminate\Foundation\Application)ï¼Œä¹Ÿå«æœåŠ¡å®¹å™¨
$app = require_once __DIR__.'/../bootstrap/app.php'; æ•´ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹åŒ…æ‹¬ï¼šæ³¨å†Œé¡¹ç›®åŸºç¡€çš„ServiceProvider,æ³¨å†ŒSerciveProviderçš„Alias,æ³¨å†Œç›®å½•è·¯å¾„ç­‰ã€‚
bootstrap/app.phpä¸­ä¹Ÿå®Œæˆäº†å†…æ ¸ç»‘å®šã€‚
Laravelä¼šä¾æ®httpè¯·æ±‚çš„è¿è¡Œç¯å¢ƒä¸åŒï¼Œå°†è¯·æ±‚å‘é€è‡³ç›¸åº”çš„å†…æ ¸HTTPå†…æ ¸ æˆ– Consoleå†…æ ¸ã€‚æ— è®ºå“ªä¸ªå†…æ ¸ï¼Œå®ƒä»¬ä½œç”¨éƒ½æ˜¯å¤„ç†httpè¯·æ±‚ã€‚
æœ€ç»ˆï¼ŒHTTPå†…æ ¸ç”¨handlemethod,å•çº¯çš„æ¥æ”¶ä¸€ä¸ªRequestä»¥åŠè¿”å›ä¸€ä¸ªResponseã€‚
HTTPå†…æ ¸ HTTPå†…æ ¸ç»§æ‰¿äº†Illuminate\Foundation\Http\Kernalç±»ï¼Œå®ƒå®šä¹‰äº†åœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰è¿è¡Œçš„ bootstrappers æ•°ç»„ã€‚åŒ…å«å®Œæˆç¯å¢ƒæ£€æµ‹ï¼Œé…ç½®åŠ è½½ï¼Œå¼‚å¸¸å¤„ç†ï¼ŒFacadesæ³¨å†Œï¼ŒServiceProvideræ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡è¿™6ä¸ªå¼•å¯¼ç¨‹åºã€‚
HTTPå†…æ ¸å®šä¹‰äº†æ‰€æœ‰è¢«è¯·æ±‚åº”ç”¨ç¨‹åºå¤„ç†ä¹‹å‰å¿…é¡»ç»è¿‡çš„HTTPä¸­é—´ä»¶åˆ—è¡¨ã€‚ è¿™äº›ä¸­é—´ä»¶å¯ä»¥å¤„ç† HTTP session çš„è¯»å†™, å¯ä»¥åˆ¤æ–­æœåŠ¡å™¨å½“å‰æ˜¯å¦å¤„äºç»´æŠ¤æ¨¡å¼, éªŒè¯ CSRF token ( ä¸ºäº†ä¿æŠ¤æœåŠ¡å™¨ä¸å— CSRF æ”»å‡» ) ç­‰ç­‰åŠŸèƒ½.
ServiceProvider æœ€é‡è¦çš„å¼•å¯¼æ“ä½œä¹‹ä¸€å°±æ˜¯åŠ è½½åº”ç”¨ç¨‹åºçš„ServiceProviderã€‚åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ServiceProvideréƒ½åœ¨config/app.phpé…ç½®æ–‡ä»¶çš„providersæ•°ç»„ä¸­é…ç½®ã€‚æ‰€æœ‰çš„provideréƒ½ä¼šè°ƒç”¨registeræ–¹æ³•ï¼Œç”±bootæ–¹æ³•è´Ÿè´£è°ƒç”¨æ‰€æœ‰çš„è¢«æ³¨å†Œproviderã€‚
ServiceProviderè´Ÿè´£å¼•å¯¼æ‰€æœ‰æ¡†æ¶çš„å„ç§ç»„ä»¶ï¼Œå¦‚æ•°æ®åº“ã€é˜Ÿåˆ—ã€éªŒè¯å’Œè·¯ç”±ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡†æ¶æä¾›çš„æ¯ä¸ªåŠŸèƒ½éƒ½å®ƒä»¬æ¥å¼•å¯¼å¹¶é…ç½®ã€‚å› æ­¤ä¹Ÿå¯ä»¥è¯´ï¼ŒServiceProvideræ˜¯æ•´ä¸ª Laravel å¼•å¯¼è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚
æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ å¤„ç†è¯·æ±‚åŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼š
 åˆ›å»ºè¯·æ±‚å®ä¾‹ å¤„ç†è¯·æ±‚  åˆ›å»ºè¯·æ±‚å®ä¾‹ è¯·æ±‚å®ä¾‹`Illuminate\Http\Request`çš„`capture()	`æ–¹æ³•ï¼Œå†…éƒ¨é€šè¿‡Symfonyå®ä¾‹åˆ›å»ºä¸€ä¸ªLaravelè¯·æ±‚å®ä¾‹  /** * Create a new Illuminate HTTP request from server variables."><meta name=author content><link rel=canonical href=http://shawnrong.github.io/posts/laravel%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/><link href=http://shawnrong.github.io/assets/css/stylesheet.min.19d8234f7520f2216aca845b9f292982671403accc7e754ceb099b228a5980fe.css integrity="sha256-GdgjT3Ug8iFqyoRbnykpgmcUA6zMfnVM6wmbIopZgP4=" rel="preload stylesheet" as=style><link rel=icon href=http://shawnrong.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://shawnrong.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://shawnrong.github.io/favicon-32x32.png><link rel=apple-touch-icon href=http://shawnrong.github.io/apple-touch-icon.png><link rel=mask-icon href=http://shawnrong.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.79.1"><meta property="og:title" content="Laravel ç”Ÿå‘½å‘¨æœŸ"><meta property="og:description" content="Laravel ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸæ¦‚è¿° å…¥å£ publuc/index.phpæ˜¯ä¸€ä¸ªLaravelåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œæ˜¯æ•´ä¸ªæ¡†æ¶çš„èµ·ç‚¹ã€‚index.phpä»£ç ä¸å¤šï¼Œä¸»è¦çš„é˜¶æ®µå°±æ˜¯ï¼š
 åŠ è½½Composeré¡¹ç›®ä¾èµ– åˆ›å»ºä¸€ä¸ªappå®ä¾‹å®¹å™¨ æ¥æ”¶å¹¶ä¸”å¤„ç†httpè¯·æ±‚  ç”Ÿå‘½å‘¨æœŸè¯¦è§£ åŠ è½½é¡¹ç›®ä¾èµ– Laravelä½¿ç”¨Composerè¿›è¡ŒåŒ…çš„ç®¡ç†ï¼Œæ‰€æœ‰ç»„ä»¶çš„åŠ è½½å·¥ä½œï¼Œä»…éœ€è¦ä¸€è¡Œä»£ç 
require __DIR__.'/../vendor/autoload.php'; åˆ›å»ºAppå®ä¾‹ æ¥ä¸‹æ¥ä¾¿æ˜¯åˆ›å»ºåº”ç”¨å®ä¾‹(Illuminate\Foundation\Application)ï¼Œä¹Ÿå«æœåŠ¡å®¹å™¨
$app = require_once __DIR__.'/../bootstrap/app.php'; æ•´ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹åŒ…æ‹¬ï¼šæ³¨å†Œé¡¹ç›®åŸºç¡€çš„ServiceProvider,æ³¨å†ŒSerciveProviderçš„Alias,æ³¨å†Œç›®å½•è·¯å¾„ç­‰ã€‚
bootstrap/app.phpä¸­ä¹Ÿå®Œæˆäº†å†…æ ¸ç»‘å®šã€‚
Laravelä¼šä¾æ®httpè¯·æ±‚çš„è¿è¡Œç¯å¢ƒä¸åŒï¼Œå°†è¯·æ±‚å‘é€è‡³ç›¸åº”çš„å†…æ ¸HTTPå†…æ ¸ æˆ– Consoleå†…æ ¸ã€‚æ— è®ºå“ªä¸ªå†…æ ¸ï¼Œå®ƒä»¬ä½œç”¨éƒ½æ˜¯å¤„ç†httpè¯·æ±‚ã€‚
æœ€ç»ˆï¼ŒHTTPå†…æ ¸ç”¨handlemethod,å•çº¯çš„æ¥æ”¶ä¸€ä¸ªRequestä»¥åŠè¿”å›ä¸€ä¸ªResponseã€‚
HTTPå†…æ ¸ HTTPå†…æ ¸ç»§æ‰¿äº†Illuminate\Foundation\Http\Kernalç±»ï¼Œå®ƒå®šä¹‰äº†åœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰è¿è¡Œçš„ bootstrappers æ•°ç»„ã€‚åŒ…å«å®Œæˆç¯å¢ƒæ£€æµ‹ï¼Œé…ç½®åŠ è½½ï¼Œå¼‚å¸¸å¤„ç†ï¼ŒFacadesæ³¨å†Œï¼ŒServiceProvideræ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡è¿™6ä¸ªå¼•å¯¼ç¨‹åºã€‚
HTTPå†…æ ¸å®šä¹‰äº†æ‰€æœ‰è¢«è¯·æ±‚åº”ç”¨ç¨‹åºå¤„ç†ä¹‹å‰å¿…é¡»ç»è¿‡çš„HTTPä¸­é—´ä»¶åˆ—è¡¨ã€‚ è¿™äº›ä¸­é—´ä»¶å¯ä»¥å¤„ç† HTTP session çš„è¯»å†™, å¯ä»¥åˆ¤æ–­æœåŠ¡å™¨å½“å‰æ˜¯å¦å¤„äºç»´æŠ¤æ¨¡å¼, éªŒè¯ CSRF token ( ä¸ºäº†ä¿æŠ¤æœåŠ¡å™¨ä¸å— CSRF æ”»å‡» ) ç­‰ç­‰åŠŸèƒ½.
ServiceProvider æœ€é‡è¦çš„å¼•å¯¼æ“ä½œä¹‹ä¸€å°±æ˜¯åŠ è½½åº”ç”¨ç¨‹åºçš„ServiceProviderã€‚åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ServiceProvideréƒ½åœ¨config/app.phpé…ç½®æ–‡ä»¶çš„providersæ•°ç»„ä¸­é…ç½®ã€‚æ‰€æœ‰çš„provideréƒ½ä¼šè°ƒç”¨registeræ–¹æ³•ï¼Œç”±bootæ–¹æ³•è´Ÿè´£è°ƒç”¨æ‰€æœ‰çš„è¢«æ³¨å†Œproviderã€‚
ServiceProviderè´Ÿè´£å¼•å¯¼æ‰€æœ‰æ¡†æ¶çš„å„ç§ç»„ä»¶ï¼Œå¦‚æ•°æ®åº“ã€é˜Ÿåˆ—ã€éªŒè¯å’Œè·¯ç”±ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡†æ¶æä¾›çš„æ¯ä¸ªåŠŸèƒ½éƒ½å®ƒä»¬æ¥å¼•å¯¼å¹¶é…ç½®ã€‚å› æ­¤ä¹Ÿå¯ä»¥è¯´ï¼ŒServiceProvideræ˜¯æ•´ä¸ª Laravel å¼•å¯¼è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚
æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ å¤„ç†è¯·æ±‚åŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼š
 åˆ›å»ºè¯·æ±‚å®ä¾‹ å¤„ç†è¯·æ±‚  åˆ›å»ºè¯·æ±‚å®ä¾‹ è¯·æ±‚å®ä¾‹`Illuminate\Http\Request`çš„`capture()	`æ–¹æ³•ï¼Œå†…éƒ¨é€šè¿‡Symfonyå®ä¾‹åˆ›å»ºä¸€ä¸ªLaravelè¯·æ±‚å®ä¾‹  /** * Create a new Illuminate HTTP request from server variables."><meta property="og:type" content="article"><meta property="og:url" content="http://shawnrong.github.io/posts/laravel%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"><meta property="article:published_time" content="2017-11-08T00:00:00+00:00"><meta property="article:modified_time" content="2017-11-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Laravel ç”Ÿå‘½å‘¨æœŸ"><meta name=twitter:description content="Laravel ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸæ¦‚è¿° å…¥å£ publuc/index.phpæ˜¯ä¸€ä¸ªLaravelåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œæ˜¯æ•´ä¸ªæ¡†æ¶çš„èµ·ç‚¹ã€‚index.phpä»£ç ä¸å¤šï¼Œä¸»è¦çš„é˜¶æ®µå°±æ˜¯ï¼š
 åŠ è½½Composeré¡¹ç›®ä¾èµ– åˆ›å»ºä¸€ä¸ªappå®ä¾‹å®¹å™¨ æ¥æ”¶å¹¶ä¸”å¤„ç†httpè¯·æ±‚  ç”Ÿå‘½å‘¨æœŸè¯¦è§£ åŠ è½½é¡¹ç›®ä¾èµ– Laravelä½¿ç”¨Composerè¿›è¡ŒåŒ…çš„ç®¡ç†ï¼Œæ‰€æœ‰ç»„ä»¶çš„åŠ è½½å·¥ä½œï¼Œä»…éœ€è¦ä¸€è¡Œä»£ç 
require __DIR__.'/../vendor/autoload.php'; åˆ›å»ºAppå®ä¾‹ æ¥ä¸‹æ¥ä¾¿æ˜¯åˆ›å»ºåº”ç”¨å®ä¾‹(Illuminate\Foundation\Application)ï¼Œä¹Ÿå«æœåŠ¡å®¹å™¨
$app = require_once __DIR__.'/../bootstrap/app.php'; æ•´ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹åŒ…æ‹¬ï¼šæ³¨å†Œé¡¹ç›®åŸºç¡€çš„ServiceProvider,æ³¨å†ŒSerciveProviderçš„Alias,æ³¨å†Œç›®å½•è·¯å¾„ç­‰ã€‚
bootstrap/app.phpä¸­ä¹Ÿå®Œæˆäº†å†…æ ¸ç»‘å®šã€‚
Laravelä¼šä¾æ®httpè¯·æ±‚çš„è¿è¡Œç¯å¢ƒä¸åŒï¼Œå°†è¯·æ±‚å‘é€è‡³ç›¸åº”çš„å†…æ ¸HTTPå†…æ ¸ æˆ– Consoleå†…æ ¸ã€‚æ— è®ºå“ªä¸ªå†…æ ¸ï¼Œå®ƒä»¬ä½œç”¨éƒ½æ˜¯å¤„ç†httpè¯·æ±‚ã€‚
æœ€ç»ˆï¼ŒHTTPå†…æ ¸ç”¨handlemethod,å•çº¯çš„æ¥æ”¶ä¸€ä¸ªRequestä»¥åŠè¿”å›ä¸€ä¸ªResponseã€‚
HTTPå†…æ ¸ HTTPå†…æ ¸ç»§æ‰¿äº†Illuminate\Foundation\Http\Kernalç±»ï¼Œå®ƒå®šä¹‰äº†åœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰è¿è¡Œçš„ bootstrappers æ•°ç»„ã€‚åŒ…å«å®Œæˆç¯å¢ƒæ£€æµ‹ï¼Œé…ç½®åŠ è½½ï¼Œå¼‚å¸¸å¤„ç†ï¼ŒFacadesæ³¨å†Œï¼ŒServiceProvideræ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡è¿™6ä¸ªå¼•å¯¼ç¨‹åºã€‚
HTTPå†…æ ¸å®šä¹‰äº†æ‰€æœ‰è¢«è¯·æ±‚åº”ç”¨ç¨‹åºå¤„ç†ä¹‹å‰å¿…é¡»ç»è¿‡çš„HTTPä¸­é—´ä»¶åˆ—è¡¨ã€‚ è¿™äº›ä¸­é—´ä»¶å¯ä»¥å¤„ç† HTTP session çš„è¯»å†™, å¯ä»¥åˆ¤æ–­æœåŠ¡å™¨å½“å‰æ˜¯å¦å¤„äºç»´æŠ¤æ¨¡å¼, éªŒè¯ CSRF token ( ä¸ºäº†ä¿æŠ¤æœåŠ¡å™¨ä¸å— CSRF æ”»å‡» ) ç­‰ç­‰åŠŸèƒ½.
ServiceProvider æœ€é‡è¦çš„å¼•å¯¼æ“ä½œä¹‹ä¸€å°±æ˜¯åŠ è½½åº”ç”¨ç¨‹åºçš„ServiceProviderã€‚åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ServiceProvideréƒ½åœ¨config/app.phpé…ç½®æ–‡ä»¶çš„providersæ•°ç»„ä¸­é…ç½®ã€‚æ‰€æœ‰çš„provideréƒ½ä¼šè°ƒç”¨registeræ–¹æ³•ï¼Œç”±bootæ–¹æ³•è´Ÿè´£è°ƒç”¨æ‰€æœ‰çš„è¢«æ³¨å†Œproviderã€‚
ServiceProviderè´Ÿè´£å¼•å¯¼æ‰€æœ‰æ¡†æ¶çš„å„ç§ç»„ä»¶ï¼Œå¦‚æ•°æ®åº“ã€é˜Ÿåˆ—ã€éªŒè¯å’Œè·¯ç”±ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡†æ¶æä¾›çš„æ¯ä¸ªåŠŸèƒ½éƒ½å®ƒä»¬æ¥å¼•å¯¼å¹¶é…ç½®ã€‚å› æ­¤ä¹Ÿå¯ä»¥è¯´ï¼ŒServiceProvideræ˜¯æ•´ä¸ª Laravel å¼•å¯¼è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚
æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ å¤„ç†è¯·æ±‚åŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼š
 åˆ›å»ºè¯·æ±‚å®ä¾‹ å¤„ç†è¯·æ±‚  åˆ›å»ºè¯·æ±‚å®ä¾‹ è¯·æ±‚å®ä¾‹`Illuminate\Http\Request`çš„`capture()	`æ–¹æ³•ï¼Œå†…éƒ¨é€šè¿‡Symfonyå®ä¾‹åˆ›å»ºä¸€ä¸ªLaravelè¯·æ±‚å®ä¾‹  /** * Create a new Illuminate HTTP request from server variables."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Laravel ç”Ÿå‘½å‘¨æœŸ","name":"Laravel ç”Ÿå‘½å‘¨æœŸ","description":"Laravel ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸæ¦‚è¿° å…¥å£ publuc/index.phpæ˜¯ä¸€ä¸ªLaravelåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œæ˜¯æ•´ä¸ªæ¡†æ¶çš„èµ·ç‚¹ã€‚index.phpä»£ç ä¸å¤šï¼Œä¸»è¦çš„é˜¶æ®µå°±æ˜¯ï¼š\n åŠ è½½Composeré¡¹ç›®ä¾èµ– åˆ›å»ºä¸€ä¸ªappå®ä¾‹å®¹å™¨ æ¥æ”¶å¹¶ä¸”å¤„ç†httpè¯·æ±‚  ç”Ÿå‘½å‘¨æœŸè¯¦è§£ åŠ è½½é¡¹ç›®ä¾èµ– Laravelä½¿ç”¨Composerè¿›è¡ŒåŒ…çš„ç®¡ç†ï¼Œæ‰€æœ‰ç»„ä»¶çš„åŠ è½½å·¥ä½œï¼Œä»… â€¦","keywords":["Laravel","PHP"],"articleBody":"Laravel ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸæ¦‚è¿° å…¥å£ publuc/index.phpæ˜¯ä¸€ä¸ªLaravelåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œæ˜¯æ•´ä¸ªæ¡†æ¶çš„èµ·ç‚¹ã€‚index.phpä»£ç ä¸å¤šï¼Œä¸»è¦çš„é˜¶æ®µå°±æ˜¯ï¼š\n åŠ è½½Composeré¡¹ç›®ä¾èµ– åˆ›å»ºä¸€ä¸ªappå®ä¾‹å®¹å™¨ æ¥æ”¶å¹¶ä¸”å¤„ç†httpè¯·æ±‚  ç”Ÿå‘½å‘¨æœŸè¯¦è§£ åŠ è½½é¡¹ç›®ä¾èµ– Laravelä½¿ç”¨Composerè¿›è¡ŒåŒ…çš„ç®¡ç†ï¼Œæ‰€æœ‰ç»„ä»¶çš„åŠ è½½å·¥ä½œï¼Œä»…éœ€è¦ä¸€è¡Œä»£ç \nrequire __DIR__.'/../vendor/autoload.php'; åˆ›å»ºAppå®ä¾‹ æ¥ä¸‹æ¥ä¾¿æ˜¯åˆ›å»ºåº”ç”¨å®ä¾‹(Illuminate\\Foundation\\Application)ï¼Œä¹Ÿå«æœåŠ¡å®¹å™¨\n$app = require_once __DIR__.'/../bootstrap/app.php'; æ•´ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹åŒ…æ‹¬ï¼šæ³¨å†Œé¡¹ç›®åŸºç¡€çš„ServiceProvider,æ³¨å†ŒSerciveProviderçš„Alias,æ³¨å†Œç›®å½•è·¯å¾„ç­‰ã€‚\nbootstrap/app.phpä¸­ä¹Ÿå®Œæˆäº†å†…æ ¸ç»‘å®šã€‚\nLaravelä¼šä¾æ®httpè¯·æ±‚çš„è¿è¡Œç¯å¢ƒä¸åŒï¼Œå°†è¯·æ±‚å‘é€è‡³ç›¸åº”çš„å†…æ ¸HTTPå†…æ ¸ æˆ– Consoleå†…æ ¸ã€‚æ— è®ºå“ªä¸ªå†…æ ¸ï¼Œå®ƒä»¬ä½œç”¨éƒ½æ˜¯å¤„ç†httpè¯·æ±‚ã€‚\næœ€ç»ˆï¼ŒHTTPå†…æ ¸ç”¨handlemethod,å•çº¯çš„æ¥æ”¶ä¸€ä¸ªRequestä»¥åŠè¿”å›ä¸€ä¸ªResponseã€‚\nHTTPå†…æ ¸ HTTPå†…æ ¸ç»§æ‰¿äº†Illuminate\\Foundation\\Http\\Kernalç±»ï¼Œå®ƒå®šä¹‰äº†åœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰è¿è¡Œçš„ bootstrappers æ•°ç»„ã€‚åŒ…å«å®Œæˆç¯å¢ƒæ£€æµ‹ï¼Œé…ç½®åŠ è½½ï¼Œå¼‚å¸¸å¤„ç†ï¼ŒFacadesæ³¨å†Œï¼ŒServiceProvideræ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡è¿™6ä¸ªå¼•å¯¼ç¨‹åºã€‚\nHTTPå†…æ ¸å®šä¹‰äº†æ‰€æœ‰è¢«è¯·æ±‚åº”ç”¨ç¨‹åºå¤„ç†ä¹‹å‰å¿…é¡»ç»è¿‡çš„HTTPä¸­é—´ä»¶åˆ—è¡¨ã€‚ è¿™äº›ä¸­é—´ä»¶å¯ä»¥å¤„ç† HTTP session çš„è¯»å†™, å¯ä»¥åˆ¤æ–­æœåŠ¡å™¨å½“å‰æ˜¯å¦å¤„äºç»´æŠ¤æ¨¡å¼, éªŒè¯ CSRF token ( ä¸ºäº†ä¿æŠ¤æœåŠ¡å™¨ä¸å— CSRF æ”»å‡» ) ç­‰ç­‰åŠŸèƒ½.\nServiceProvider æœ€é‡è¦çš„å¼•å¯¼æ“ä½œä¹‹ä¸€å°±æ˜¯åŠ è½½åº”ç”¨ç¨‹åºçš„ServiceProviderã€‚åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ServiceProvideréƒ½åœ¨config/app.phpé…ç½®æ–‡ä»¶çš„providersæ•°ç»„ä¸­é…ç½®ã€‚æ‰€æœ‰çš„provideréƒ½ä¼šè°ƒç”¨registeræ–¹æ³•ï¼Œç”±bootæ–¹æ³•è´Ÿè´£è°ƒç”¨æ‰€æœ‰çš„è¢«æ³¨å†Œproviderã€‚\nServiceProviderè´Ÿè´£å¼•å¯¼æ‰€æœ‰æ¡†æ¶çš„å„ç§ç»„ä»¶ï¼Œå¦‚æ•°æ®åº“ã€é˜Ÿåˆ—ã€éªŒè¯å’Œè·¯ç”±ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡†æ¶æä¾›çš„æ¯ä¸ªåŠŸèƒ½éƒ½å®ƒä»¬æ¥å¼•å¯¼å¹¶é…ç½®ã€‚å› æ­¤ä¹Ÿå¯ä»¥è¯´ï¼ŒServiceProvideræ˜¯æ•´ä¸ª Laravel å¼•å¯¼è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚\næ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ å¤„ç†è¯·æ±‚åŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼š\n åˆ›å»ºè¯·æ±‚å®ä¾‹ å¤„ç†è¯·æ±‚  åˆ›å»ºè¯·æ±‚å®ä¾‹ è¯·æ±‚å®ä¾‹`Illuminate\\Http\\Request`çš„`capture()\t`æ–¹æ³•ï¼Œå†…éƒ¨é€šè¿‡Symfonyå®ä¾‹åˆ›å»ºä¸€ä¸ªLaravelè¯·æ±‚å®ä¾‹  /** * Create a new Illuminate HTTP request from server variables. * * @class Illuminate\\Http\\Request * @return static */ public static function capture() { static::enableHttpMethodParameterOverride(); return static::createFromBase(SymfonyRequest::createFromGlobals()); } /** * Create an Illuminate request from a Symfony instance. * * @see https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Request.php * @param \\Symfony\\Component\\HttpFoundation\\Request $request * @return \\Illuminate\\Http\\Request */ public static function createFromBase(SymfonyRequest $request) { if ($request instanceof static) { return $request; } $content = $request-content; $request = (new static)-duplicate( $request-query-all(), $request-request-all(), $request-attributes-all(), $request-cookies-all(), $request-files-all(), $request-server-all() ); $request-content = $content; $request-request = $request-getInputSource(); return $request; } å¤„ç†è¯·æ±‚ è¯·æ±‚å¤„ç†å‘ç”Ÿåœ¨HTTPå†…æ ¸çš„handle()æ–¹æ³•å†…\n/** * Handle an incoming HTTP request. * * @class Illuminate\\Foundation\\Http\\Kernel * @param \\Illuminate\\Http\\Request $request * @return \\Illuminate\\Http\\Response */ public function handle($request) { try { $request-enableHttpMethodParameterOverride(); $response = $this-sendRequestThroughRouter($request); } catch (Exception $e) { $this-reportException($e); $response = $this-renderException($request, $e); } catch (Throwable $e) { $this-reportException($e = new FatalThrowableError($e)); $response = $this-renderException($request, $e); } $this-app['events']-dispatch( new Events\\RequestHandled($request, $response) ); return $response; } handle()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªHTTPå“åº”ã€‚\nå‘é€å“åº” å‘é€å“åº”ç”±Illuminate\\Http\\Responseçˆ¶ç±»Symfony\\Component\\HttpFoundation\\Responseä¸­çš„send()æ–¹æ³•å®Œæˆã€‚\n/** * Sends HTTP headers and content. * * @see https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Response.php * @return $this */ public function send() { $this-sendHeaders();// å‘é€å“åº”å¤´éƒ¨ä¿¡æ¯  $this-sendContent();// å‘é€æŠ¥æ–‡ä¸»é¢˜  if (function_exists('fastcgi_finish_request')) { fastcgi_finish_request(); } elseif (!\\in_array(PHP_SAPI, array('cli', 'phpdbg'), true)) { static::closeOutputBuffers(0, true); } return $this; } ç»ˆæ­¢ç¨‹åº ç¨‹åºç»ˆæ­¢ï¼Œå®ŒæˆterminateMiddlewareçš„è°ƒç”¨\nå‚è€ƒ   æ·±åº¦æŒ–æ˜ Laravel ç”Ÿå‘½å‘¨æœŸ Request Life Cycle of Laravel Laravelè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ Laravel çš„è¯·æ±‚å‘¨æœŸ   ","wordCount":"263","inLanguage":"en","datePublished":"2017-11-08T00:00:00Z","dateModified":"2017-11-08T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://shawnrong.github.io/posts/laravel%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},"publisher":{"@type":"Organization","name":"ğŸ’ŠTime Capsule","logo":{"@type":"ImageObject","url":"http://shawnrong.github.io/favicon.ico"}}}</script></head><body id=top><script>if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=http://shawnrong.github.io/ accesskey=h title="ğŸ’ŠTime Capsule (Alt + H)">ğŸ’ŠTime Capsule</a>
<span class=logo-switches></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=http://shawnrong.github.io/search title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li><li><a href=http://shawnrong.github.io/tags title=ğŸ·ï¸><span>ğŸ·ï¸</span></a></li><li><a href=http://shawnrong.github.io/archive title=ğŸ§³><span>ğŸ§³</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Laravel ç”Ÿå‘½å‘¨æœŸ</h1><div class=post-description></div><div class=post-meta>November 8, 2017&nbsp;Â·&nbsp;2 min</div></header><div class=post-content><h1 id=laravel-ç”Ÿå‘½å‘¨æœŸ>Laravel ç”Ÿå‘½å‘¨æœŸ<a hidden class=anchor aria-hidden=true href=#laravel-ç”Ÿå‘½å‘¨æœŸ>#</a></h1><h2 id=ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°>ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°<a hidden class=anchor aria-hidden=true href=#ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°>#</a></h2><h3 id=å…¥å£>å…¥å£<a hidden class=anchor aria-hidden=true href=#å…¥å£>#</a></h3><p><code>publuc/index.php</code>æ˜¯ä¸€ä¸ªLaravelåº”ç”¨ç¨‹åºçš„å…¥å£ï¼Œæ˜¯æ•´ä¸ªæ¡†æ¶çš„èµ·ç‚¹ã€‚<code>index.php</code>ä»£ç ä¸å¤šï¼Œä¸»è¦çš„é˜¶æ®µå°±æ˜¯ï¼š</p><ol><li>åŠ è½½Composeré¡¹ç›®ä¾èµ–</li><li>åˆ›å»ºä¸€ä¸ªappå®ä¾‹å®¹å™¨</li><li>æ¥æ”¶å¹¶ä¸”å¤„ç†httpè¯·æ±‚</li></ol><h2 id=ç”Ÿå‘½å‘¨æœŸè¯¦è§£>ç”Ÿå‘½å‘¨æœŸè¯¦è§£<a hidden class=anchor aria-hidden=true href=#ç”Ÿå‘½å‘¨æœŸè¯¦è§£>#</a></h2><h3 id=åŠ è½½é¡¹ç›®ä¾èµ–>åŠ è½½é¡¹ç›®ä¾èµ–<a hidden class=anchor aria-hidden=true href=#åŠ è½½é¡¹ç›®ä¾èµ–>#</a></h3><p>Laravelä½¿ç”¨Composerè¿›è¡ŒåŒ…çš„ç®¡ç†ï¼Œæ‰€æœ‰ç»„ä»¶çš„åŠ è½½å·¥ä½œï¼Œä»…éœ€è¦ä¸€è¡Œä»£ç </p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#66d9ef>require</span> <span style=color:#66d9ef>__DIR__</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/../vendor/autoload.php&#39;</span>;
</code></pre></div><h3 id=åˆ›å»ºappå®ä¾‹>åˆ›å»ºAppå®ä¾‹<a hidden class=anchor aria-hidden=true href=#åˆ›å»ºappå®ä¾‹>#</a></h3><p>æ¥ä¸‹æ¥ä¾¿æ˜¯åˆ›å»ºåº”ç”¨å®ä¾‹(<code>Illuminate\Foundation\Application</code>)ï¼Œä¹Ÿå«æœåŠ¡å®¹å™¨</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$app <span style=color:#f92672>=</span> <span style=color:#66d9ef>require_once</span> <span style=color:#66d9ef>__DIR__</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/../bootstrap/app.php&#39;</span>;
</code></pre></div><p>æ•´ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹åŒ…æ‹¬ï¼šæ³¨å†Œé¡¹ç›®åŸºç¡€çš„ServiceProvider,æ³¨å†ŒSerciveProviderçš„Alias,æ³¨å†Œç›®å½•è·¯å¾„ç­‰ã€‚</p><p><code>bootstrap/app.php</code>ä¸­ä¹Ÿå®Œæˆäº†å†…æ ¸ç»‘å®šã€‚</p><p>Laravelä¼šä¾æ®httpè¯·æ±‚çš„è¿è¡Œç¯å¢ƒä¸åŒï¼Œå°†è¯·æ±‚å‘é€è‡³ç›¸åº”çš„å†…æ ¸<strong>HTTPå†…æ ¸</strong> æˆ– <strong>Consoleå†…æ ¸</strong>ã€‚æ— è®ºå“ªä¸ªå†…æ ¸ï¼Œå®ƒä»¬ä½œç”¨éƒ½æ˜¯å¤„ç†httpè¯·æ±‚ã€‚</p><p>æœ€ç»ˆï¼ŒHTTPå†…æ ¸ç”¨<code>handle</code>method,å•çº¯çš„æ¥æ”¶ä¸€ä¸ª<code>Request</code>ä»¥åŠè¿”å›ä¸€ä¸ª<code>Response</code>ã€‚</p><h4 id=httpå†…æ ¸>HTTPå†…æ ¸<a hidden class=anchor aria-hidden=true href=#httpå†…æ ¸>#</a></h4><p>HTTPå†…æ ¸ç»§æ‰¿äº†<code>Illuminate\Foundation\Http\Kernal</code>ç±»ï¼Œå®ƒå®šä¹‰äº†åœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰è¿è¡Œçš„ <code>bootstrappers</code> æ•°ç»„ã€‚åŒ…å«å®Œæˆç¯å¢ƒæ£€æµ‹ï¼Œé…ç½®åŠ è½½ï¼Œå¼‚å¸¸å¤„ç†ï¼ŒFacadesæ³¨å†Œï¼ŒServiceProvideræ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡è¿™6ä¸ªå¼•å¯¼ç¨‹åºã€‚</p><p>HTTPå†…æ ¸å®šä¹‰äº†æ‰€æœ‰è¢«è¯·æ±‚åº”ç”¨ç¨‹åºå¤„ç†ä¹‹å‰å¿…é¡»ç»è¿‡çš„HTTPä¸­é—´ä»¶åˆ—è¡¨ã€‚ è¿™äº›ä¸­é—´ä»¶å¯ä»¥å¤„ç† HTTP session çš„è¯»å†™, å¯ä»¥åˆ¤æ–­æœåŠ¡å™¨å½“å‰æ˜¯å¦å¤„äºç»´æŠ¤æ¨¡å¼, éªŒè¯ CSRF token ( ä¸ºäº†ä¿æŠ¤æœåŠ¡å™¨ä¸å— <a href=https://laravel-china.org/docs/laravel/5.2/routing#csrf-protection>CSRF æ”»å‡»</a> ) ç­‰ç­‰åŠŸèƒ½.</p><h4 id=serviceprovider>ServiceProvider<a hidden class=anchor aria-hidden=true href=#serviceprovider>#</a></h4><p>æœ€é‡è¦çš„å¼•å¯¼æ“ä½œä¹‹ä¸€å°±æ˜¯åŠ è½½åº”ç”¨ç¨‹åºçš„ServiceProviderã€‚åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ServiceProvideréƒ½åœ¨<code>config/app.php</code>é…ç½®æ–‡ä»¶çš„<code>providers</code>æ•°ç»„ä¸­é…ç½®ã€‚æ‰€æœ‰çš„provideréƒ½ä¼šè°ƒç”¨<code>register</code>æ–¹æ³•ï¼Œç”±<code>boot</code>æ–¹æ³•è´Ÿè´£è°ƒç”¨æ‰€æœ‰çš„è¢«æ³¨å†Œproviderã€‚</p><p>ServiceProviderè´Ÿè´£å¼•å¯¼æ‰€æœ‰æ¡†æ¶çš„å„ç§ç»„ä»¶ï¼Œå¦‚æ•°æ®åº“ã€é˜Ÿåˆ—ã€éªŒè¯å’Œè·¯ç”±ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡†æ¶æä¾›çš„æ¯ä¸ªåŠŸèƒ½éƒ½å®ƒä»¬æ¥å¼•å¯¼å¹¶é…ç½®ã€‚å› æ­¤ä¹Ÿå¯ä»¥è¯´ï¼ŒServiceProvideræ˜¯æ•´ä¸ª Laravel å¼•å¯¼è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ–¹é¢ã€‚</p><h3 id=æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚>æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚<a hidden class=anchor aria-hidden=true href=#æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚>#</a></h3><p>å¤„ç†è¯·æ±‚åŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼š</p><ul><li>åˆ›å»ºè¯·æ±‚å®ä¾‹</li><li>å¤„ç†è¯·æ±‚</li></ul><h4 id=åˆ›å»ºè¯·æ±‚å®ä¾‹>åˆ›å»ºè¯·æ±‚å®ä¾‹<a hidden class=anchor aria-hidden=true href=#åˆ›å»ºè¯·æ±‚å®ä¾‹>#</a></h4><pre><code>è¯·æ±‚å®ä¾‹`Illuminate\Http\Request`çš„`capture()	`æ–¹æ³•ï¼Œå†…éƒ¨é€šè¿‡Symfonyå®ä¾‹åˆ›å»ºä¸€ä¸ªLaravelè¯·æ±‚å®ä¾‹
</code></pre><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>    <span style=color:#e6db74>/**
</span><span style=color:#e6db74>     * Create a new Illuminate HTTP request from server variables.
</span><span style=color:#e6db74>     *
</span><span style=color:#e6db74>     * @class Illuminate\Http\Request
</span><span style=color:#e6db74>     * @return static
</span><span style=color:#e6db74>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>capture</span>()
    {
        <span style=color:#66d9ef>static</span><span style=color:#f92672>::</span><span style=color:#a6e22e>enableHttpMethodParameterOverride</span>();
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>static</span><span style=color:#f92672>::</span><span style=color:#a6e22e>createFromBase</span>(<span style=color:#a6e22e>SymfonyRequest</span><span style=color:#f92672>::</span><span style=color:#a6e22e>createFromGlobals</span>());
    }

    <span style=color:#e6db74>/**
</span><span style=color:#e6db74>     * Create an Illuminate request from a Symfony instance.
</span><span style=color:#e6db74>     *
</span><span style=color:#e6db74>     * @see https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Request.php
</span><span style=color:#e6db74>     * @param  \Symfony\Component\HttpFoundation\Request  $request
</span><span style=color:#e6db74>     * @return \Illuminate\Http\Request
</span><span style=color:#e6db74>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>createFromBase</span>(<span style=color:#a6e22e>SymfonyRequest</span> $request)
    {
        <span style=color:#66d9ef>if</span> ($request <span style=color:#a6e22e>instanceof</span> <span style=color:#66d9ef>static</span>) {
            <span style=color:#66d9ef>return</span> $request;
        }

        $content <span style=color:#f92672>=</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>content</span>;

        $request <span style=color:#f92672>=</span> (<span style=color:#66d9ef>new</span> <span style=color:#66d9ef>static</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>duplicate</span>(
            $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>query</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>(), $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>request</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>(), $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>attributes</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>(),
            $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>cookies</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>(), $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>files</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>(), $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>server</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>()
        );

        $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>content</span> <span style=color:#f92672>=</span> $content;

        $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>request</span> <span style=color:#f92672>=</span> $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getInputSource</span>();

        <span style=color:#66d9ef>return</span> $request;
    }
</code></pre></div><h4 id=å¤„ç†è¯·æ±‚>å¤„ç†è¯·æ±‚<a hidden class=anchor aria-hidden=true href=#å¤„ç†è¯·æ±‚>#</a></h4><p>è¯·æ±‚å¤„ç†å‘ç”Ÿåœ¨HTTPå†…æ ¸çš„<code>handle()</code>æ–¹æ³•å†…</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#e6db74>/**
</span><span style=color:#e6db74>     * Handle an incoming HTTP request.
</span><span style=color:#e6db74>     *
</span><span style=color:#e6db74>     * @class Illuminate\Foundation\Http\Kernel
</span><span style=color:#e6db74>     * @param  \Illuminate\Http\Request  $request
</span><span style=color:#e6db74>     * @return \Illuminate\Http\Response
</span><span style=color:#e6db74>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handle</span>($request)
    {
        <span style=color:#66d9ef>try</span> {
            $request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>enableHttpMethodParameterOverride</span>();

            $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sendRequestThroughRouter</span>($request);
        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>Exception</span> $e) {
            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reportException</span>($e);

            $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>renderException</span>($request, $e);
        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>Throwable</span> $e) {
            $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>reportException</span>($e <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FatalThrowableError</span>($e));

            $response <span style=color:#f92672>=</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>renderException</span>($request, $e);
        }

        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>app</span>[<span style=color:#e6db74>&#39;events&#39;</span>]<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>dispatch</span>(
            <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Events\RequestHandled</span>($request, $response)
        );

        <span style=color:#66d9ef>return</span> $response;
    }

</code></pre></div><p><code>handle()</code>æ–¹æ³•æ¥æ”¶ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªHTTPå“åº”ã€‚</p><h3 id=å‘é€å“åº”>å‘é€å“åº”<a hidden class=anchor aria-hidden=true href=#å‘é€å“åº”>#</a></h3><p>å‘é€å“åº”ç”±<code>Illuminate\Http\Response</code>çˆ¶ç±»<code>Symfony\Component\HttpFoundation\Response</code>ä¸­çš„<code>send()</code>æ–¹æ³•å®Œæˆã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>   <span style=color:#e6db74>/**
</span><span style=color:#e6db74>     * Sends HTTP headers and content.
</span><span style=color:#e6db74>     *
</span><span style=color:#e6db74>     * @see https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Response.php
</span><span style=color:#e6db74>     * @return $this
</span><span style=color:#e6db74>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>send</span>()
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sendHeaders</span>();<span style=color:#75715e>// å‘é€å“åº”å¤´éƒ¨ä¿¡æ¯
</span><span style=color:#75715e></span>        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>sendContent</span>();<span style=color:#75715e>// å‘é€æŠ¥æ–‡ä¸»é¢˜
</span><span style=color:#75715e></span>
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>function_exists</span>(<span style=color:#e6db74>&#39;fastcgi_finish_request&#39;</span>)) {
            <span style=color:#a6e22e>fastcgi_finish_request</span>();
        } <span style=color:#66d9ef>elseif</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>\in_array</span>(<span style=color:#a6e22e>PHP_SAPI</span>, <span style=color:#66d9ef>array</span>(<span style=color:#e6db74>&#39;cli&#39;</span>, <span style=color:#e6db74>&#39;phpdbg&#39;</span>), <span style=color:#66d9ef>true</span>)) {
            <span style=color:#66d9ef>static</span><span style=color:#f92672>::</span><span style=color:#a6e22e>closeOutputBuffers</span>(<span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>true</span>);
        }
        <span style=color:#66d9ef>return</span> $this;
    }
</code></pre></div><h3 id=ç»ˆæ­¢ç¨‹åº>ç»ˆæ­¢ç¨‹åº<a hidden class=anchor aria-hidden=true href=#ç»ˆæ­¢ç¨‹åº>#</a></h3><p>ç¨‹åºç»ˆæ­¢ï¼Œå®Œæˆ<code>terminateMiddleware</code>çš„è°ƒç”¨</p><h3 id=å‚è€ƒ>å‚è€ƒ<a hidden class=anchor aria-hidden=true href=#å‚è€ƒ>#</a></h3><blockquote><ul><li><a href=https://laravel-china.org/articles/10421/depth-mining-of-laravel-life-cycle>æ·±åº¦æŒ–æ˜ Laravel ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href=http://blog.mallow-tech.com/2016/06/request-life-cycle-of-laravel/>Request Life Cycle of Laravel</a></li><li><a href=https://www.dyike.com/2017/04/22/laravel-request-life-cycle/>Laravelè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href=https://laravel-china.org/docs/laravel/5.6/lifecycle/1358>Laravel çš„è¯·æ±‚å‘¨æœŸ</a></li></ul></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=http://shawnrong.github.io/tags/laravel/>Laravel</a></li><li><a href=http://shawnrong.github.io/tags/php/>PHP</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=http://shawnrong.github.io/>ğŸ’ŠTime Capsule</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=http://shawnrong.github.io/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});if(id==="top"){history.replaceState(null,null," ");}else{history.replaceState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script></body></html>